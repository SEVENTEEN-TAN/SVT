# SVTå‰ç«¯é€€å‡ºç™»å½•åŠŸèƒ½è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°
SVTå‰ç«¯åº”ç”¨å®ç°äº†å®Œæ•´çš„é€€å‡ºç™»å½•åŠŸèƒ½ï¼ŒåŒ…æ‹¬åç«¯APIè°ƒç”¨ã€æœ¬åœ°çŠ¶æ€æ¸…é™¤ã€Tokenç®¡ç†ç­‰ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ” å®‰å…¨é€€å‡º
- è°ƒç”¨åç«¯ `GET /api/auth/logout` æ¥å£
- æœåŠ¡ç«¯Tokenå¤±æ•ˆå¤„ç†
- æœ¬åœ°çŠ¶æ€å®Œå…¨æ¸…é™¤
- é˜²æ­¢Tokenæ³„éœ²

### ğŸ”„ å¼‚æ­¥å¤„ç†
- æ”¯æŒå¼‚æ­¥é€€å‡ºç™»å½•æµç¨‹
- å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶
- å³ä½¿ç½‘ç»œå¤±è´¥ä¹Ÿèƒ½æ­£å¸¸é€€å‡º
- ç”¨æˆ·å‹å¥½çš„åŠ è½½çŠ¶æ€

### ğŸ“Š çŠ¶æ€ç›‘æ§
- å®æ—¶TokençŠ¶æ€ç›‘æ§
- å‰©ä½™æ—¶é—´æ˜¾ç¤º
- è¿‡æœŸé¢„è­¦æœºåˆ¶
- è‡ªåŠ¨ç™»å‡ºå¤„ç†

## ä½¿ç”¨æ–¹æ³•

### åœ¨ç»„ä»¶ä¸­ä½¿ç”¨é€€å‡ºç™»å½•

```typescript
import { useAuthStore } from '@/stores/authStore';

const MyComponent = () => {
  const { logout } = useAuthStore();

  const handleLogout = async () => {
    try {
      await logout();
      // é€€å‡ºæˆåŠŸï¼Œå¯ä»¥è¿›è¡Œé¡µé¢è·³è½¬ç­‰æ“ä½œ
      navigate('/login');
    } catch (error) {
      console.error('é€€å‡ºç™»å½•å¤±è´¥:', error);
      // å¤„ç†é”™è¯¯æƒ…å†µ
    }
  };

  return (
    <Button onClick={handleLogout}>
      é€€å‡ºç™»å½•
    </Button>
  );
};
```

### ä½¿ç”¨TokençŠ¶æ€ç›‘æ§

```typescript
import { useTokenStatus } from '@/hooks/useTokenStatus';

const TokenStatusComponent = () => {
  const tokenStatus = useTokenStatus();

  return (
    <div>
      <p>å‰©ä½™æ—¶é—´: {tokenStatus.remainingTimeText}</p>
      <p>çŠ¶æ€: {tokenStatus.isExpired ? 'å·²è¿‡æœŸ' : 'æ­£å¸¸'}</p>
    </div>
  );
};
```

## APIæ¥å£

### é€€å‡ºç™»å½•æ¥å£
- **åœ°å€**: `GET /api/auth/logout`
- **è®¤è¯**: éœ€è¦Bearer Token
- **å“åº”**: æ ‡å‡†Resultæ ¼å¼

```json
{
  "code": 0,
  "message": "é€€å‡ºæˆåŠŸ",
  "data": {},
  "success": true,
  "timestamp": 1699123456789,
  "traceId": "abc123"
}
```

## é€€å‡ºç™»å½•æµç¨‹

### 1. ç”¨æˆ·è§¦å‘é€€å‡º
- ç‚¹å‡»é€€å‡ºç™»å½•æŒ‰é’®
- ç³»ç»Ÿè‡ªåŠ¨è¿‡æœŸç™»å‡º
- å…¶ä»–è§¦å‘åœºæ™¯

### 2. è°ƒç”¨åç«¯æ¥å£
```typescript
// è°ƒç”¨åç«¯é€€å‡ºç™»å½•æ¥å£
await api.get('/auth/logout');
```

### 3. æ¸…é™¤æœ¬åœ°çŠ¶æ€
```typescript
// åœæ­¢Tokenç®¡ç†å™¨
tokenManager.stop();

// æ¸…é™¤localStorage
localStorage.removeItem('token');
localStorage.removeItem('user');
localStorage.removeItem('expiryDate');

// é‡ç½®ZustandçŠ¶æ€
set({
  user: null,
  token: null,
  isAuthenticated: false,
  loading: false,
  expiryDate: null,
});
```

### 4. é¡µé¢è·³è½¬
```typescript
// è·³è½¬åˆ°ç™»å½•é¡µ
navigate('/login');
```

## é”™è¯¯å¤„ç†

### ç½‘ç»œé”™è¯¯
- åç«¯æ¥å£è°ƒç”¨å¤±è´¥æ—¶ï¼Œå‰ç«¯ä»ä¼šæ¸…é™¤æœ¬åœ°çŠ¶æ€
- ç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿæ­£å¸¸é€€å‡ºï¼Œä¸ä¼šå¡åœ¨ç™»å½•çŠ¶æ€

### Tokenè¿‡æœŸ
- è‡ªåŠ¨æ£€æµ‹Tokenè¿‡æœŸ
- æ˜¾ç¤ºå‹å¥½çš„è¿‡æœŸæç¤º
- è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

### å¼‚å¸¸æƒ…å†µ
- å®Œå–„çš„try-catché”™è¯¯æ•è·
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- æ—¥å¿—è®°å½•ä¾¿äºè°ƒè¯•

## é…ç½®é€‰é¡¹

### Tokenæ£€æŸ¥é—´éš”
```typescript
// åœ¨tokenManagerä¸­é…ç½®
private readonly TOKEN_CHECK_INTERVAL = 30 * 1000; // 30ç§’
```

### é¢„è­¦é˜ˆå€¼
```typescript
// æå‰2åˆ†é’Ÿé¢„è­¦
private readonly WARNING_THRESHOLD = 2 * 60 * 1000;
```

### Hookæ›´æ–°é—´éš”
```typescript
// ä½¿ç”¨useTokenStatusæ—¶å¯è‡ªå®šä¹‰æ›´æ–°é—´éš”
const tokenStatus = useTokenStatus(10000); // 10ç§’æ›´æ–°ä¸€æ¬¡
```

## æµ‹è¯•æ–¹æ³•

### åŠŸèƒ½æµ‹è¯•
å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æµ‹è¯•é€€å‡ºç™»å½•åŠŸèƒ½ï¼š

1. **æ­£å¸¸é€€å‡º**: ç™»å½•åç‚¹å‡»å³ä¸Šè§’ç”¨æˆ·å¤´åƒä¸‹æ‹‰èœå•ä¸­çš„"é€€å‡ºç™»å½•"æŒ‰é’®
2. **ç½‘ç»œå¼‚å¸¸**: æ–­ç½‘æƒ…å†µä¸‹æµ‹è¯•é€€å‡ºåŠŸèƒ½ï¼ŒéªŒè¯æœ¬åœ°çŠ¶æ€æ¸…é™¤
3. **Tokenè¿‡æœŸ**: ç­‰å¾…Tokenè‡ªåŠ¨è¿‡æœŸï¼ŒéªŒè¯è‡ªåŠ¨ç™»å‡ºåŠŸèƒ½
4. **å¹¶å‘é€€å‡º**: å¤šä¸ªæ ‡ç­¾é¡µåŒæ—¶é€€å‡ºï¼ŒéªŒè¯çŠ¶æ€åŒæ­¥

## æœ€ä½³å®è·µ

### 1. é”™è¯¯å¤„ç†
```typescript
const handleLogout = async () => {
  try {
    message.loading('æ­£åœ¨é€€å‡º...', 0);
    await logout();
    message.destroy();
    message.success('é€€å‡ºæˆåŠŸ');
    navigate('/login');
  } catch (error) {
    message.destroy();
    message.error('é€€å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•');
    console.error('é€€å‡ºç™»å½•å¤±è´¥:', error);
  }
};
```

### 2. ç”¨æˆ·ä½“éªŒ
- æ˜¾ç¤ºåŠ è½½çŠ¶æ€
- æä¾›æˆåŠŸ/å¤±è´¥åé¦ˆ
- åˆç†çš„è·³è½¬æ—¶æœº
- å‹å¥½çš„é”™è¯¯æç¤º

### 3. å®‰å…¨è€ƒè™‘
- ç¡®ä¿Tokenå®Œå…¨æ¸…é™¤
- é˜²æ­¢æ•æ„Ÿä¿¡æ¯æ®‹ç•™
- åŠæ—¶çš„çŠ¶æ€åŒæ­¥
- å®‰å…¨çš„é¡µé¢è·³è½¬

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: é€€å‡ºç™»å½•åä»æ˜¾ç¤ºå·²ç™»å½•çŠ¶æ€**
A: æ£€æŸ¥localStorageæ˜¯å¦æ­£ç¡®æ¸…é™¤ï¼Œç¡®è®¤ZustandçŠ¶æ€æ˜¯å¦é‡ç½®

**Q: åç«¯æ¥å£è°ƒç”¨å¤±è´¥**
A: æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAPIåœ°å€é…ç½®ï¼ŒæŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

**Q: TokençŠ¶æ€ç›‘æ§ä¸å‡†ç¡®**
A: ç¡®è®¤Tokenæ ¼å¼æ­£ç¡®ï¼Œæ£€æŸ¥æ—¶é—´åŒæ­¥é—®é¢˜

**Q: è‡ªåŠ¨ç™»å‡ºä¸å·¥ä½œ**
A: æ£€æŸ¥tokenManageræ˜¯å¦æ­£ç¡®å¯åŠ¨ï¼Œç¡®è®¤å®šæ—¶å™¨é…ç½®

### è°ƒè¯•æ–¹æ³•
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
2. æŸ¥çœ‹Networkæ ‡ç­¾é¡µçš„APIè¯·æ±‚
3. æ£€æŸ¥Consoleä¸­çš„é”™è¯¯ä¿¡æ¯
4. éªŒè¯localStorageçš„çŠ¶æ€å˜åŒ–
5. è§‚å¯ŸZustandçŠ¶æ€çš„å˜åŒ– 