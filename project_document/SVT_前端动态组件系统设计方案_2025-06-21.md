# SVT å‰ç«¯åŠ¨æ€ç»„ä»¶ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ

**é¡¹ç›®**: SVT-Web å‰ç«¯åŠ¨æ€ç»„ä»¶ç³»ç»Ÿ
**ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2025-06-21 21:27:30 +08:00
**æ–‡æ¡£ç±»å‹**: æŠ€æœ¯è®¾è®¡æ–¹æ¡ˆ
**é€‚ç”¨é¢†åŸŸ**: é«˜å®‰å…¨æ€§ä¼ä¸šå†…éƒ¨ç³»ç»Ÿ

## ğŸ“‹ æ–‡æ¡£è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†é˜è¿°SVTå‰ç«¯åŠ¨æ€ç»„ä»¶ç³»ç»Ÿçš„å®Œæ•´è®¾è®¡æ–¹æ¡ˆï¼Œæ—¨åœ¨é€šè¿‡é…ç½®é©±åŠ¨çš„æ–¹å¼ç®€åŒ–å‰ç«¯é¡µé¢å¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡å’Œä»£ç å¤ç”¨æ€§ã€‚

---

## ğŸ¯ é¡¹ç›®ç›®æ ‡

### æ ¸å¿ƒç›®æ ‡
1. **ç®€åŒ–å¼€å‘**ï¼šé€šè¿‡é…ç½®æ–‡ä»¶å¿«é€Ÿç”Ÿæˆé¡µé¢ï¼Œå‡å°‘é‡å¤ä»£ç 
2. **æé«˜æ•ˆç‡**ï¼šå°†é¡µé¢å¼€å‘ä»"ç¼–ç¨‹é¢˜"å˜æˆ"å¡«ç©ºé¢˜"
3. **ç»Ÿä¸€è§„èŒƒ**ï¼šæ ‡å‡†åŒ–é¡µé¢ç»“æ„å’Œäº¤äº’æ¨¡å¼
4. **æ˜“äºç»´æŠ¤**ï¼šé…ç½®åŒ–ç®¡ç†ï¼Œéœ€æ±‚å˜æ›´åªéœ€ä¿®æ”¹é…ç½®æ–‡ä»¶

### ä¸šåŠ¡ä»·å€¼
- å¼€å‘æ•ˆç‡æå‡60%ä»¥ä¸Š
- ä»£ç å¤ç”¨ç‡æå‡80%
- ç»´æŠ¤æˆæœ¬é™ä½50%
- æ–°äººä¸Šæ‰‹æ—¶é—´ç¼©çŸ­70%

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„è®¾è®¡

```mermaid
graph TB
    subgraph "é…ç½®å±‚"
        CONFIG["JSON Schemaé…ç½®"]
        TEMPLATE["é¡µé¢æ¨¡æ¿"]
        RULES["ä¸šåŠ¡è§„åˆ™"]
    end
    
    subgraph "è§£æå±‚"
        PARSER["Schemaè§£æå™¨"]
        VALIDATOR["é…ç½®éªŒè¯å™¨"]
        OPTIMIZER["æ€§èƒ½ä¼˜åŒ–å™¨"]
    end
    
    subgraph "æ¸²æŸ“å±‚"
        RENDERER["åŠ¨æ€æ¸²æŸ“å™¨"]
        COMPONENTS["ç»„ä»¶åº“"]
        EVENTS["äº‹ä»¶ç®¡ç†å™¨"]
    end
    
    subgraph "æ‰©å±•å±‚"
        PLUGINS["æ’ä»¶ç³»ç»Ÿ"]
        CUSTOM["è‡ªå®šä¹‰ç»„ä»¶"]
        LOGIC["ä¸šåŠ¡é€»è¾‘å¤„ç†å™¨"]
    end
    
    CONFIG --> PARSER
    TEMPLATE --> PARSER
    RULES --> PARSER
    PARSER --> RENDERER
    VALIDATOR --> RENDERER
    OPTIMIZER --> RENDERER
    RENDERER --> COMPONENTS
    RENDERER --> EVENTS
    EVENTS --> PLUGINS
    COMPONENTS --> CUSTOM
    EVENTS --> LOGIC
```

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

#### 1. 80-15-5åŸåˆ™
- **80%åœºæ™¯**ï¼šçº¯é…ç½®è§£å†³ï¼ˆæ ‡å‡†CRUDé¡µé¢ï¼‰
- **15%åœºæ™¯**ï¼šé…ç½®+æ‰©å±•è§£å†³ï¼ˆå¤æ‚ä¸šåŠ¡é€»è¾‘ï¼‰
- **5%åœºæ™¯**ï¼šå®Œå…¨è‡ªå®šä¹‰è§£å†³ï¼ˆç‰¹æ®ŠUIéœ€æ±‚ï¼‰

#### 2. æ¸è¿›å¼å¢å¼º
```typescript
// Level 1: åŸºç¡€é…ç½®
interface BasicConfig {
  pageType: 'list' | 'info';
  title: string;
  api: ApiConfig;
  fields: FieldConfig[];
}

// Level 2: å¢å¼ºé…ç½®
interface EnhancedConfig extends BasicConfig {
  events?: EventConfig[];
  validation?: ValidationConfig;
  dependencies?: DependencyConfig;
}

// Level 3: é«˜çº§é…ç½®
interface AdvancedConfig extends EnhancedConfig {
  customComponents?: CustomComponentConfig;
  businessLogic?: BusinessLogicConfig;
  extensions?: ExtensionConfig;
}
```

---

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 1. é¡µé¢ç»„æˆç»“æ„

```typescript
interface PageStructure {
  // æ£€ç´¢æ¡†ç»„ä»¶
  searchForm?: SearchFormConfig;
  
  // å·¥å…·æ æŒ‰é’®
  toolbar?: ToolbarConfig;
  
  // æ•°æ®è¡¨æ ¼
  table?: TableConfig;
  
  // è¯¦æƒ…è¡¨å•
  infoForm?: InfoFormConfig;
  
  // è‡ªå®šä¹‰åŒºåŸŸ
  customAreas?: CustomAreaConfig[];
}
```

### 2. æ™ºèƒ½ç å€¼ç®¡ç†

```typescript
// ç å€¼ç®¡ç†å™¨
class CodeValueManager {
  private cache = new Map<string, any>();
  private dependencies = new Map<string, string[]>();
  
  // è·å–ç å€¼é€‰é¡¹
  async getCodeOptions(codeType: string, context?: any): Promise<Option[]> {
    const cacheKey = this.generateCacheKey(codeType, context);
    
    if (this.cache.has(cacheKey)) {
      return this.cache.get(cacheKey);
    }
    
    const options = await this.fetchCodeValues(codeType, context);
    this.cache.set(cacheKey, options);
    return options;
  }
  
  // å¤„ç†ä¾èµ–æ›´æ–°
  invalidateDependencies(changedField: string): void {
    const dependentFields = this.dependencies.get(changedField) || [];
    dependentFields.forEach(field => {
      this.clearCache(field);
    });
  }
}
```

### 3. äº‹ä»¶é©±åŠ¨è”åŠ¨æœºåˆ¶

```typescript
// å…¨å±€äº‹ä»¶ç®¡ç†å™¨
class PageEventManager {
  private eventBus = new EventEmitter();
  private actionExecutor = new ActionExecutor();
  
  // å¤„ç†é…ç½®äº‹ä»¶
  handleConfigEvent(eventConfig: EventConfig, triggerData: any): void {
    eventConfig.actions.forEach(action => {
      this.actionExecutor.execute(action, triggerData);
    });
  }
  
  // æ”¯æŒçš„åŠ¨ä½œç±»å‹
  private supportedActions = [
    'apiCall',        // APIè°ƒç”¨
    'updateComponent', // æ›´æ–°ç»„ä»¶
    'showModal',      // æ˜¾ç¤ºå¼¹çª—
    'hideComponent',  // éšè—ç»„ä»¶
    'customLogic'     // è‡ªå®šä¹‰é€»è¾‘
  ];
}
```

---

## ğŸ“„ é…ç½®è§„èŒƒç¤ºä¾‹

### å®Œæ•´é¡µé¢é…ç½®
```json
{
  "pageType": "list",
  "title": "ç”¨æˆ·ç®¡ç†",
  
  "globalData": {
    "selectedUser": null,
    "userRiskProfile": null
  },
  
  "events": [
    {
      "name": "userSelected",
      "trigger": {
        "component": "searchForm",
        "field": "userId",
        "event": "onChange"
      },
      "actions": [
        {
          "type": "apiCall",
          "api": "/api/users/{userId}/risk-profile",
          "target": "globalData.userRiskProfile"
        },
        {
          "type": "updateComponent",
          "component": "userTable",
          "action": "refresh"
        }
      ]
    }
  ],
  
  "searchForm": {
    "layout": "inline",
    "fields": [
      {
        "key": "userName",
        "label": "ç”¨æˆ·å",
        "type": "input",
        "placeholder": "è¯·è¾“å…¥ç”¨æˆ·å"
      },
      {
        "key": "status",
        "label": "çŠ¶æ€",
        "type": "select",
        "codeType": "USER_STATUS"
      }
    ]
  },
  
  "toolbar": {
    "buttons": [
      {
        "key": "add",
        "label": "æ–°å¢",
        "type": "primary",
        "action": "openModal",
        "target": "userInfoModal"
      }
    ]
  },
  
  "table": {
    "api": "/api/users",
    "selection": true,
    "columns": [
      {
        "key": "userName",
        "title": "ç”¨æˆ·å",
        "width": 120
      },
      {
        "key": "status",
        "title": "çŠ¶æ€",
        "width": 80,
        "render": "codeValue",
        "codeType": "USER_STATUS"
      }
    ]
  }
}
```

---

## ğŸš€ å®æ–½è®¡åˆ’

### æ€»ä½“ç­–ç•¥ï¼šæ¸è¿›å¼å¼€å‘
**Aåˆ†æ”¯ï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰â†’ Båˆ†æ”¯ï¼ˆé…ç½®åŒ–å‡çº§ï¼‰â†’ å…¶ä»–ç¯å¢ƒåˆ†æ”¯**

### é˜¶æ®µä¸€ï¼šAåˆ†æ”¯ - åŸºç¡€åŠŸèƒ½å®Œå–„ï¼ˆ6-8å‘¨ï¼‰

#### 1. Demoé¡µé¢å¼€å‘ï¼ˆ2å‘¨ï¼‰
- [ ] èœå•ç®¡ç†é¡µé¢ (List + Info)
- [ ] ç”¨æˆ·ç®¡ç†é¡µé¢ (List + Info)
- [ ] è§’è‰²ç®¡ç†é¡µé¢ (List + Info)
- [ ] æƒé™ç®¡ç†é¡µé¢ (List + Info)
- [ ] ä½¿ç”¨ä¼ ç»Ÿç»„ä»¶æ–¹å¼ï¼Œä¸å¼•å…¥é…ç½®åŒ–å¤æ‚åº¦

#### 2. APIä½“ç³»å®Œå–„ï¼ˆ2å‘¨ï¼‰
- [ ] èœå•ç®¡ç†API (CRUD + æ ‘å½¢ç»“æ„)
- [ ] ç”¨æˆ·ç®¡ç†API (CRUD + çŠ¶æ€ç®¡ç†)
- [ ] è§’è‰²ç®¡ç†API (CRUD + æƒé™åˆ†é…)
- [ ] æƒé™ç®¡ç†API (CRUD + å±‚çº§ç®¡ç†)

#### 3. æƒé™æ§åˆ¶ç³»ç»Ÿï¼ˆ2-3å‘¨ï¼‰
- [ ] é¡µé¢çº§æƒé™æ§åˆ¶
- [ ] æŒ‰é’®çº§æƒé™æ§åˆ¶ï¼ˆå…ƒç´ æ˜¾ç¤º/éšè—ï¼‰
- [ ] APIçº§æƒé™æ§åˆ¶ï¼ˆè¯·æ±‚æ‹¦æˆªï¼‰
- [ ] æƒé™æ§åˆ¶ç»„ä»¶åº“
- [ ] æƒé™ç®¡ç†ç•Œé¢

#### 4. æµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ä»£ç é‡æ„
- [ ] æ–‡æ¡£å®Œå–„

### é˜¶æ®µäºŒï¼šBåˆ†æ”¯ - é…ç½®åŒ–å‡çº§ï¼ˆ4-6å‘¨ï¼‰

#### 1. é…ç½®åŒ–æ¶æ„æ­å»ºï¼ˆ2å‘¨ï¼‰
- [ ] åŸºäºAåˆ†æ”¯åˆ›å»ºBåˆ†æ”¯
- [ ] Schemaè§£æå™¨å®ç°
- [ ] åŠ¨æ€æ¸²æŸ“å™¨å¼€å‘
- [ ] é…ç½®éªŒè¯å™¨

#### 2. é¡µé¢é…ç½®åŒ–æ”¹é€ ï¼ˆ2å‘¨ï¼‰
- [ ] æå–Aåˆ†æ”¯é¡µé¢é…ç½®Schema
- [ ] æ”¹é€ ä¸ºé…ç½®é©±åŠ¨æ¨¡å¼
- [ ] ä¿æŒAPIå’Œæƒé™ç³»ç»Ÿå…¼å®¹
- [ ] åŠŸèƒ½å®Œå…¨å¯¹ç­‰éªŒè¯

#### 3. é…ç½®åŒ–å·¥å…·å¼€å‘ï¼ˆ1-2å‘¨ï¼‰
- [ ] Schemaç”Ÿæˆå™¨
- [ ] é…ç½®ç®¡ç†ç•Œé¢
- [ ] é¡µé¢é¢„è§ˆå·¥å…·
- [ ] é…ç½®è¿ç§»å·¥å…·

### é˜¶æ®µä¸‰ï¼šå…¶ä»–ç¯å¢ƒåˆ†æ”¯ï¼ˆå¹¶è¡Œå¼€å‘ï¼‰

#### åŸºäºAåˆ†æ”¯æˆ–Båˆ†æ”¯åˆ›å»º
- [ ] Cåˆ†æ”¯ï¼šDockerå®¹å™¨åŒ–éƒ¨ç½²
- [ ] Dåˆ†æ”¯ï¼šå¾®æœåŠ¡æ¶æ„æ‹†åˆ†
- [ ] Eåˆ†æ”¯ï¼šäº‘åŸç”Ÿæ”¹é€ 
- [ ] æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åŸºç¡€åˆ†æ”¯

---

## ğŸ”„ åˆ†æ”¯ç®¡ç†ç­–ç•¥

### åˆ†æ”¯å…³ç³»å›¾
```mermaid
graph TB
    MAIN["mainåˆ†æ”¯<br/>(ç”Ÿäº§ç¯å¢ƒ)"]
    A["Aåˆ†æ”¯<br/>(åŸºç¡€åŠŸèƒ½å®Œå–„)"]
    B["Båˆ†æ”¯<br/>(é…ç½®åŒ–å‡çº§)"]
    C["Cåˆ†æ”¯<br/>(Dockeréƒ¨ç½²)"]
    D["Dåˆ†æ”¯<br/>(å¾®æœåŠ¡æ‹†åˆ†)"]
    E["Eåˆ†æ”¯<br/>(äº‘åŸç”Ÿæ”¹é€ )"]

    MAIN --> A
    A --> B
    A --> C
    B --> D
    B --> E

    A -.->|å®šæœŸåˆå¹¶| MAIN
    B -.->|éªŒè¯ååˆå¹¶| MAIN
```

### åˆ†æ”¯ç­–ç•¥è¯´æ˜

#### Aåˆ†æ”¯ï¼šåŸºç¡€åŠŸèƒ½åˆ†æ”¯
- **ç›®æ ‡**ï¼šå®Œå–„æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½å’Œæƒé™ä½“ç³»
- **ç‰¹ç‚¹**ï¼šä½¿ç”¨ä¼ ç»Ÿå¼€å‘æ–¹å¼ï¼Œç¨³å®šå¯é 
- **åˆå¹¶ç­–ç•¥**ï¼šåŠŸèƒ½ç¨³å®šåå®šæœŸåˆå¹¶åˆ°mainåˆ†æ”¯

#### Båˆ†æ”¯ï¼šé…ç½®åŒ–å‡çº§åˆ†æ”¯
- **ç›®æ ‡**ï¼šåœ¨Aåˆ†æ”¯åŸºç¡€ä¸Šå®ç°é…ç½®åŒ–å‡çº§
- **ç‰¹ç‚¹**ï¼šä¿æŒåŠŸèƒ½å®Œå…¨å…¼å®¹ï¼Œæå‡å¼€å‘æ•ˆç‡
- **åˆå¹¶ç­–ç•¥**ï¼šå……åˆ†éªŒè¯ååˆå¹¶åˆ°mainåˆ†æ”¯

#### å…¶ä»–ç¯å¢ƒåˆ†æ”¯
- **åŸºç¡€é€‰æ‹©**ï¼šæ ¹æ®éœ€æ±‚é€‰æ‹©åŸºäºAåˆ†æ”¯æˆ–Båˆ†æ”¯
- **å¹¶è¡Œå¼€å‘**ï¼šå¯ä»¥åœ¨Aåˆ†æ”¯ç¨³å®šåå¹¶è¡Œè¿›è¡Œ
- **åˆå¹¶ç­–ç•¥**ï¼šæ ¹æ®å…·ä½“æƒ…å†µå†³å®šåˆå¹¶æ—¶æœº

### å¼€å‘æµç¨‹

#### 1. å½“å‰é˜¶æ®µï¼ˆAåˆ†æ”¯å¼€å‘ï¼‰
```bash
# åœ¨Aåˆ†æ”¯è¿›è¡ŒåŸºç¡€åŠŸèƒ½å¼€å‘
git checkout A-branch
# å¼€å‘èœå•ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½
# å®Œå–„æƒé™æ§åˆ¶ç³»ç»Ÿ
```

#### 2. é…ç½®åŒ–é˜¶æ®µï¼ˆBåˆ†æ”¯å¼€å‘ï¼‰
```bash
# åŸºäºAåˆ†æ”¯åˆ›å»ºBåˆ†æ”¯
git checkout A-branch
git checkout -b B-config-upgrade
# è¿›è¡Œé…ç½®åŒ–æ”¹é€ 
```

#### 3. ç¯å¢ƒæ”¹é€ é˜¶æ®µï¼ˆå…¶ä»–åˆ†æ”¯ï¼‰
```bash
# æ ¹æ®éœ€è¦é€‰æ‹©åŸºç¡€åˆ†æ”¯
git checkout A-branch  # æˆ– B-branch
git checkout -b C-docker-deployment
# è¿›è¡Œç¯å¢ƒç‰¹å®šæ”¹é€ 
```

### è´¨é‡ä¿è¯

#### ä»£ç å®¡æŸ¥
- Aåˆ†æ”¯ï¼šé‡ç‚¹å…³æ³¨åŠŸèƒ½å®Œæ•´æ€§å’Œæƒé™å®‰å…¨æ€§
- Båˆ†æ”¯ï¼šé‡ç‚¹å…³æ³¨é…ç½®åŒ–æ¶æ„å’Œå…¼å®¹æ€§
- å…¶ä»–åˆ†æ”¯ï¼šé‡ç‚¹å…³æ³¨ç¯å¢ƒé€‚é…å’Œéƒ¨ç½²ç¨³å®šæ€§

#### æµ‹è¯•ç­–ç•¥
- **å•å…ƒæµ‹è¯•**ï¼šæ¯ä¸ªåˆ†æ”¯éƒ½è¦ä¿è¯å•å…ƒæµ‹è¯•è¦†ç›–ç‡
- **é›†æˆæµ‹è¯•**ï¼šAåˆ†æ”¯é‡ç‚¹æµ‹è¯•ä¸šåŠ¡æµç¨‹
- **å…¼å®¹æ€§æµ‹è¯•**ï¼šBåˆ†æ”¯é‡ç‚¹æµ‹è¯•ä¸Aåˆ†æ”¯çš„åŠŸèƒ½å¯¹ç­‰æ€§
- **ç¯å¢ƒæµ‹è¯•**ï¼šå…¶ä»–åˆ†æ”¯é‡ç‚¹æµ‹è¯•éƒ¨ç½²å’Œè¿è¡Œç¯å¢ƒ

---

## âš ï¸ é£é™©è¯„ä¼°

### æŠ€æœ¯é£é™©
1. **é…ç½®å¤æ‚åº¦**ï¼šå¤æ‚ä¸šåŠ¡åœºæ™¯é…ç½®æ–‡ä»¶å¯èƒ½è¿‡äºå¤æ‚
   - **ç¼“è§£æªæ–½**ï¼šæä¾›é…ç½®ç”Ÿæˆå·¥å…·å’Œæ¨¡æ¿
2. **æ€§èƒ½é—®é¢˜**ï¼šåŠ¨æ€æ¸²æŸ“å¯èƒ½å½±å“æ€§èƒ½
   - **ç¼“è§£æªæ–½**ï¼šå®ç°æ™ºèƒ½ç¼“å­˜å’Œæ‡’åŠ è½½
3. **è°ƒè¯•å›°éš¾**ï¼šé…ç½®é”™è¯¯æ—¶æ’æŸ¥å›°éš¾
   - **ç¼“è§£æªæ–½**ï¼šæä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œè°ƒè¯•å·¥å…·

### ä¸šåŠ¡é£é™©
1. **å­¦ä¹ æˆæœ¬**ï¼šå¼€å‘è€…éœ€è¦å­¦ä¹ æ–°çš„é…ç½®è§„èŒƒ
   - **ç¼“è§£æªæ–½**ï¼šæä¾›å®Œæ•´çš„æ–‡æ¡£å’ŒåŸ¹è®­
2. **æ‰©å±•é™åˆ¶**ï¼šæŸäº›ç‰¹æ®Šéœ€æ±‚å¯èƒ½æ— æ³•é…ç½®åŒ–
   - **ç¼“è§£æªæ–½**ï¼šä¿ç•™å®Œå…¨è‡ªå®šä¹‰çš„èƒ½åŠ›

---

## ğŸ“ˆ é¢„æœŸæ”¶ç›Š

### å¼€å‘æ•ˆç‡æå‡
- æ ‡å‡†é¡µé¢å¼€å‘æ—¶é—´ä»2-3å¤©ç¼©çŸ­åˆ°0.5-1å¤©
- ä»£ç å¤ç”¨ç‡ä»30%æå‡åˆ°80%
- Bugç‡é™ä½40%ï¼ˆæ ‡å‡†åŒ–å‡å°‘é”™è¯¯ï¼‰

### ç»´æŠ¤æˆæœ¬é™ä½
- éœ€æ±‚å˜æ›´å“åº”æ—¶é—´ç¼©çŸ­60%
- ä»£ç ç»´æŠ¤å·¥ä½œé‡å‡å°‘50%
- æ–°äººåŸ¹è®­æ—¶é—´ç¼©çŸ­70%

---

## ğŸ” æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. æ ¸å¿ƒHookè®¾è®¡

```typescript
// ç»Ÿä¸€æ•°æ®ç®¡ç†Hook
export const useSchemaPage = <T = any>(config: {
  schemaPath: string;
  id?: string;
  mode?: 'view' | 'edit' | 'create';
}) => {
  const [data, setData] = useState<T>();
  const [loading, setLoading] = useState(false);
  const [schema, setSchema] = useState<PageSchema>();

  // è‡ªåŠ¨åŠ è½½Schemaé…ç½®
  useEffect(() => {
    loadSchema(config.schemaPath).then(setSchema);
  }, [config.schemaPath]);

  // è‡ªåŠ¨å¤„ç†æ•°æ®åŠ è½½
  useEffect(() => {
    if (config.id && schema?.api?.detail) {
      setLoading(true);
      loadData(schema.api.detail, config.id)
        .then(setData)
        .finally(() => setLoading(false));
    }
  }, [config.id, schema]);

  // ä¿å­˜æ•°æ®
  const save = useCallback(async (formData: T) => {
    const api = config.id ? schema?.api?.update : schema?.api?.create;
    if (api) {
      return await saveData(api, formData, config.id);
    }
  }, [config.id, schema]);

  return { data, loading, save, schema };
};
```

### 2. åŠ¨æ€æ¸²æŸ“å™¨å®ç°

```typescript
// å­—æ®µæ¸²æŸ“å™¨
export const FieldRenderer: React.FC<FieldRendererProps> = ({
  field,
  value,
  onChange,
  formData,
  pageContext
}) => {
  const { codeValueManager, eventManager } = pageContext;

  // å¤„ç†ç å€¼å­—æ®µ
  const [options, setOptions] = useState<Option[]>([]);

  useEffect(() => {
    if (field.codeType) {
      const dependencies = field.dependencies?.reduce((acc, dep) => {
        acc[dep] = formData[dep];
        return acc;
      }, {} as Record<string, any>);

      codeValueManager.getCodeOptions(field.codeType, dependencies)
        .then(setOptions);
    }
  }, [field.codeType, field.dependencies, formData]);

  // å¤„ç†å­—æ®µå˜åŒ–
  const handleChange = useCallback((newValue: any) => {
    onChange(newValue);

    // è§¦å‘äº‹ä»¶
    eventManager.emit('fieldChange', {
      field: field.key,
      value: newValue,
      formData: { ...formData, [field.key]: newValue }
    });
  }, [onChange, field.key, formData, eventManager]);

  // æ ¹æ®å­—æ®µç±»å‹æ¸²æŸ“
  switch (field.type) {
    case 'input':
      return <Input {...field} value={value} onChange={handleChange} />;
    case 'select':
      return (
        <Select
          {...field}
          value={value}
          onChange={handleChange}
          options={options}
        />
      );
    case 'date':
      return <DatePicker {...field} value={value} onChange={handleChange} />;
    default:
      return null;
  }
};
```

### 3. å¤æ‚è”åŠ¨å¤„ç†

```typescript
// åŠ¨ä½œæ‰§è¡Œå™¨
export class ActionExecutor {
  constructor(
    private pageContext: PageContext,
    private componentRegistry: ComponentRegistry
  ) {}

  async execute(action: ActionConfig, context: any): Promise<any> {
    switch (action.type) {
      case 'apiCall':
        return this.executeApiCall(action, context);
      case 'updateComponent':
        return this.updateComponent(action, context);
      case 'conditionalAction':
        return this.executeConditionalAction(action, context);
      case 'customLogic':
        return this.executeCustomLogic(action, context);
    }
  }

  private async executeApiCall(action: ApiCallAction, context: any) {
    const url = this.interpolateUrl(action.api, context);
    const result = await api.request({
      url,
      method: action.method || 'GET',
      data: action.data
    });

    // å°†ç»“æœå­˜å‚¨åˆ°æŒ‡å®šä½ç½®
    if (action.target) {
      this.setNestedValue(this.pageContext.globalData, action.target, result);
    }

    return result;
  }

  private updateComponent(action: UpdateComponentAction, context: any) {
    const component = this.componentRegistry.get(action.component);
    if (component) {
      component.update(action.action, action.params);
    }
  }

  private async executeConditionalAction(action: ConditionalAction, context: any) {
    const condition = this.evaluateCondition(action.condition, context);
    if (condition) {
      for (const subAction of action.actions) {
        await this.execute(subAction, context);
      }
    }
  }
}
```

## ğŸ› ï¸ å¼€å‘å·¥å…·æ”¯æŒ

### 1. SchemaéªŒè¯å™¨
```typescript
// é…ç½®æ–‡ä»¶éªŒè¯
export const validateSchema = (schema: any): ValidationResult => {
  const errors: string[] = [];

  // éªŒè¯å¿…å¡«å­—æ®µ
  if (!schema.pageType) {
    errors.push('pageType is required');
  }

  // éªŒè¯å­—æ®µé…ç½®
  if (schema.fields) {
    schema.fields.forEach((field: any, index: number) => {
      if (!field.key) {
        errors.push(`Field at index ${index} missing key`);
      }
      if (!field.type) {
        errors.push(`Field ${field.key} missing type`);
      }
    });
  }

  return {
    valid: errors.length === 0,
    errors
  };
};
```

### 2. é…ç½®ç”Ÿæˆå™¨
```typescript
// å¯è§†åŒ–é…ç½®å·¥å…·
export class SchemaBuilder {
  private schema: PageSchema = {
    pageType: 'list',
    title: '',
    fields: []
  };

  addField(fieldConfig: FieldConfig): this {
    this.schema.fields.push(fieldConfig);
    return this;
  }

  addEvent(eventConfig: EventConfig): this {
    if (!this.schema.events) {
      this.schema.events = [];
    }
    this.schema.events.push(eventConfig);
    return this;
  }

  export(): PageSchema {
    return { ...this.schema };
  }

  preview(): React.ComponentType {
    return () => <DynamicPage schema={this.schema} />;
  }
}
```

---

**æ–‡æ¡£çŠ¶æ€**: è¯¦ç»†è®¾è®¡å®Œæˆ
**ä¸‹ä¸€æ­¥**: å¼€å§‹å®æ–½é˜¶æ®µä¸€çš„åŸºç¡€æ¡†æ¶å¼€å‘
**è´Ÿè´£äºº**: å‰ç«¯å¼€å‘å›¢é˜Ÿ
**é¢„è®¡å®Œæˆæ—¶é—´**: 2025-08-21

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.1 (2025-06-21 21:27:30 +08:00)
- è°ƒæ•´å®æ–½ç­–ç•¥ä¸ºæ¸è¿›å¼å¼€å‘
- é‡æ–°è§„åˆ’ä¸ºAåˆ†æ”¯ï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰â†’ Båˆ†æ”¯ï¼ˆé…ç½®åŒ–å‡çº§ï¼‰
- æ·»åŠ è¯¦ç»†çš„åˆ†æ”¯ç®¡ç†ç­–ç•¥
- å®Œå–„æƒé™æ§åˆ¶ç³»ç»Ÿè®¾è®¡
- ä¼˜åŒ–å¼€å‘æµç¨‹å’Œè´¨é‡ä¿è¯æœºåˆ¶

### v1.0 (2025-06-21 21:27:30 +08:00)
- åˆå§‹ç‰ˆæœ¬åˆ›å»º
- å®Œæˆæ•´ä½“æ¶æ„è®¾è®¡
- å®šä¹‰æ ¸å¿ƒç»„ä»¶å’Œé…ç½®è§„èŒƒ
- åˆ¶å®šå®æ–½è®¡åˆ’å’Œé£é™©è¯„ä¼°
